@{
    Layout = "_SearchLayout";
}
@using DASoTiemChung.Controllers
@using DASoTiemChung.Dtos

@{
    int i = 1;
    var thongtinTraCuu = ViewBag.ThongTinTraCuu as ThongTinTiemChungOutputDto;
}

@section Styles {
    <style type="text/css">
        .content-data{
              margin-top:80px;
              min-height: calc(100% - 80px);
          }
        @@media only screen and (max-width: 600px) {
          .content-data{
              margin-top:200px;
              min-height: calc(100% - 200px);
          }
        }

    </style>
}

    <div class="container content-data">
        <div class="page-heading">
            <div class="page-title">
                <div class="row">
                    <div class="col-12 col-md-6 order-md-1 order-last">
                        <h3>@Html.Raw(ViewBag.Title)</h3>

                    </div>
                    <div class="col-12 col-md-6 order-md-2 order-first">
                        <nav aria-label="breadcrumb" class="breadcrumb-header float-start float-lg-end">
                            <ol class="breadcrumb">
                                @*<li class="breadcrumb-item"><a href="javascript:;">Dữ liệu cơ bản (v2)</a></li>*@
                                @*<li class="breadcrumb-item active" aria-current="page">Quản lý trường học (v2)</li>*@
                            </ol>
                        </nav>
                    </div>
                </div>
            </div>
            <section class="section">
                <div class="card border">
                    <div class="card-header d-flex align-items-center">
                        <h4 class="card-title m-0">Tra cứu chứng nhận tiêm</h4>

                    </div>
                    <div class="card-content show" id="search">
                        <div class="card-body">
                            <form id="searchForm" class="form" asp-controller="TraCuuTiemChung" asp-action="Index" method="get">
                                <div class="row">
                                    <div class="col-md-3 col-12">
                                        <div class="form-group">
                                            <label for="searchTenNguoiDan">Tên người dân(*)</label>
                                            <div class="position-relative">
                                                <input type="text" id="searchTenNguoiDan" class="form-control"
                                                   placeholder="Nhập tên người dân muốn tìm" name="TenNguoiDan">
                                                  
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-3 col-12">
                                        <div class="form-group">
                                            <label for="searchSoCccdhc">Số căn cước công dân</label>
                                            <div class="position-relative">
                                                <input type="text" id="searchSoCccdhc" class="form-control"
                                                   placeholder="Nhập số căn cước công dân muốn tìm" name="SoCCCDHC">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3 col-12">
                                        <div class="form-group">
                                            <label for="searchNS">Ngày Sinh(*)</label>
                                            <div class="position-relative">
                                            <input type="date" class="form-control" id="searchNS" name="NgaySinh">
                                            </div>
                                        </div>
                                    </div>
                                
                                    <div class="col-md-3 col-12">
                                    <div class="form-group">
                                        <label for="searchSoDT">Số điện thoại(*)</label>
                                        <div class="position-relative">
                                            <input type="text" id="searchSoDT" class="form-control"
                                                   placeholder="Số điện thoại" name="SoDienThoai">
                                        </div>
                                    </div>
                                    </div>

                                </div>
                                <div class="row">
                                    <div class="col-12 d-flex justify-content-end">
                                        <button type="submit" id="btnCheckEmpty"
                                            class="btn btn-primary me-1 mb-1">
                                            Tra cứu
                                        </button>
                                        @*<button type="reset"
                                    class="btn btn-light-secondary me-1 mb-1">
                                    Reset
                                    </button>*@
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Striped rows start -->
            <section class="section">
                <div class="container">
                    @if (@TempData["Message"] != null)
                {
                    <div class="text-danger text-center">@TempData["Message"]</div>
                }
                else
                {
                    <div id="dataTable" style="min-height: 100px;">

                        <div  class="row ng-star-inserted">
                            <div  class="col-lg-9">
                                <div  class="w-100 text-center">
                                    <p  class="text-uppercase fw-bolder mb-1">
                                        CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM
                                    </p>
                                    <p  class="fw-bolder">
                                        Độc lập - Tự do - Hạnh phúc
                                    </p>
                                </div>
                                <div  class="w-100 mt-4 text-center mb-4">
                                    <h4  class="fw-bolder">
                                        CHỨNG NHẬN TIÊM CHỦNG COVID-19
                                    </h4>
                                </div>
                                <div  class="row">
                                    <div  class="col-lg-4 col-md-6">
                                        <p  class="mb-1 fw-semibold">Họ và tên</p>
                                        <p  class="fw-bolder text-dark">@thongtinTraCuu.HoTen</p>
                                    </div>
                                    <div  class="col-lg-4 col-md-6">
                                        <p  class="mb-1 fw-semibold">Ngày sinh</p>
                                        <p  class="fw-bolder text-dark">@thongtinTraCuu.NgaySinh.ToString("dd/MM/yyyy")</p>
                                    </div>
                                    <div  class="col-lg-4 col-md-6">
                                        <p  class="mb-1 fw-semibold">CCCD/HC</p>
                                        <p  class="fw-bolder text-dark">
                                            @thongtinTraCuu.CCCD
                                        </p>
                                    </div>
                                    <div  class="col-lg-4 col-md-6">
                                        <p  class="mb-1 fw-semibold">Số thẻ BHYT</p>
                                        <p  class="fw-bolder text-dark">@thongtinTraCuu.BHYT</p>
                                    </div>
                                    <div  class="col-lg-4 col-md-6">
                                        <p  class="mb-1 fw-semibold">Số điện thoại</p>
                                        <p  class="fw-bolder text-dark">@thongtinTraCuu.SoDienThoai</p>
                                    </div>
                                    <div  class="col-12">
                                        <p  class="mb-1 fw-semibold">Địa chỉ</p>
                                        <p  class="fw-bolder text-dark">
                                           @thongtinTraCuu.DiaChi
                                        </p>
                                    </div>
                                    <div  class="col-12">
                                        <p  class="mb-1 fw-semibold">Kết luận</p>
                                        <p  class="fw-bolder text-dark">
                                           Đã tiêm @thongtinTraCuu.DanhSachPhieuTiems.Count mũi vắc xin.
                                        </p>
                                    </div>
                                    
                                    <div  class="col-12 table-responsive">
                                        <table  class="table table-bordered table-hover">
                                            <thead >
                                                <tr  class="bg-light text-dark">
                                                    <th  class="text-center">Mũi số</th>
                                                    <th  class="text-center">
                                                        Thời gian tiêm
                                                    </th>
                                                    <th  class="text-center">
                                                        Tên vắc xin
                                                    </th>
                                                    <th  class="text-center">Lô</th>
                                                    <th  class="text-center">Nơi tiêm</th>
                                                </tr>
                                            </thead>
                                            <tbody >
                                                <!---->
                                                @foreach (var combo in thongtinTraCuu.DanhSachPhieuTiems)
                                            {
                                                <tr  class="ng-star-inserted">
                                                    <td  class="text-center" scope="row">
                                                            @Html.Raw(combo.MaMuiTiemNavigation?.TenMuiTiem)
                                                    </td>
                                                    <td  class="text-center">
                                                            @Html.Raw(combo.ThoiGianTiem?.ToString("dd/MM/yyyy"))
                                                    </td>
                                                    <td  class="text-center">
                                                       @Html.Raw(combo.MaVacXinTheoLoNavigation?.MaVacXinNavigation?.TenVacXin)
                                                    </td>
                                                    <td  class="text-center">
                                                            @Html.Raw(combo.MaVacXinTheoLoNavigation?.MaLoNavigation?.TenLo)
                                                    </td>
                                                    <td  class="text-center">
                                                            @Html.Raw(combo.MaKhoNavigation?.TenKho)
                                                    </td>
                                                </tr>
                                            }
                                            </tbody>
                                        </table>
                                    </div>
                                    <!---->
                                </div>
                            </div>
                            <div  class="col-lg-3 rounded-3 p-4 shadow-lg h-100 bg-success ">
                                <div  class="row">

                                    <div  class="col-12 text-center text-white mt-2 mb-2 pt-2 pb-2 pl-0 pr-0">
                                        <h4  class="text-uppercase fw-bolder">
                                            Quét mã QR thông tin tiêm chủng
                                        </h4>
                                    </div>
                                    <div  class="col-12 text-center mb-3 p-2">
                                        <ngx-qrcode >
                                            <div class="qrcode text-center">
                                                <img src="@ViewBag.QrCodeUri" class="w-75"/>
                                            </div>
                                        </ngx-qrcode>
                                    </div>
                                    <div  class="col-12">
                                        <div  class="w-100 p-3 bg-white rounded">
                                            <div  class="d-flex text-dark">
                                                <div  style="width: 30px">
                                                    <i  class="icofont-business-man"></i>
                                                </div>
                                                <div  class="w-100">
                                                    <p  class="mb-1">Họ và tên</p>
                                                    <p  class="fw-bolder text-dark">
                                                        @thongtinTraCuu.HoTen
                                                    </p>
                                                </div>
                                            </div>
                                            <div  class="d-flex text-dark">
                                                <div  style="width: 30px">
                                                    <i  class="icofont-birthday-cake"></i>
                                                </div>
                                                <div  class="w-100">
                                                    <p  class="mb-1">Ngày sinh</p>
                                                    <p  class="fw-bolder">@thongtinTraCuu.NgaySinh.ToString("dd/MM/yyyy")</p>
                                                </div>
                                            </div>
                                            <div  class="d-flex text-dark">
                                                <div  style="width: 30px">
                                                    <i  class="icofont-ui-v-card"></i>
                                                </div>
                                                <div  class="w-100">
                                                    <p  class="mb-1">CCCD/HC</p>
                                                    <p  class="fw-bolder">@thongtinTraCuu.CCCD</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                }




            </div>
        </section>
        <!-- Striped rows end -->
    </div>
    <div class="modal fade" id="detailModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
            </div>
        </div>
    </div>
</div>


@section Scripts {
    <script type="text/javascript">
        $(document).ready(function() {
            
        }); 
        let params = new URLSearchParams(window.location.search);
            let tenND = params.get('TenNguoiDan');
            let soCCCD = params.get('SoCCCDHC');
            let soDT=params.get('SoDienThoai');
            let NS=params.get('NgaySinh');
            $("#searchTenNguoiDan").val(tenND);
            $("#searchSoCccdhc").val(soCCCD);
            $("#searchSoDT").val(soDT);
            $("#searchNS").val(NS);



    </script>
     
}